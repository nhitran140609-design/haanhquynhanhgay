<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>AI Quiz Game</title>
<style>
    body {
        margin: 0; padding: 0;
        display: flex; justify-content: center; align-items: center;
        height: 100vh; background: #f0f0f0; font-family: Arial;
    }
    #gameContainer { text-align: center; }
    canvas { border: 2px solid #333; background: #fff; margin-bottom: 20px; }
    #result { font-size: 24px; font-weight: bold; height: 30px; }
    .correct { color: green; }
    .wrong { color: red; }
    button {
        padding: 10px 20px; background: #4CAF50; color: #fff;
        border: none; border-radius: 6px; cursor: pointer; margin: 5px;
    }
</style>
</head>
<body>
<div id="gameContainer">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="result"></div>

    <!-- üéµ B·∫°n t·ª± g·∫Øn file -->
    <audio id="correctSound" src="correct.mp3"></audio>
    <audio id="wrongSound" src="wrong.mp3"></audio>
    <audio id="bgMusic" src="bgmusic.mp3" loop></audio>

    <button id="musicBtn">üîä B·∫≠t/T·∫Øt nh·∫°c</button>
    <button id="restartBtn">Ch∆°i l·∫°i</button>
    <p>Nh·∫•n ph√≠m 1,2,3,4 ƒë·ªÉ ch·ªçn ƒë√°p √°n</p>
</div>

<script>
// ================== AUDIO ===================
const correctSound = document.getElementById("correctSound");
const wrongSound   = document.getElementById("wrongSound");
const bgMusic      = document.getElementById("bgMusic");

// ================== CANVAS ===================
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");
const musicBtn = document.getElementById("musicBtn");

// Images
const charNeutral = new Image();
const charHappy = new Image();
const charSad = new Image();
const bg = new Image();

bg.src = "background.jpg";
charNeutral.src = "character_neutral.png";
charHappy.src = "character_happy.png";
charSad.src = "character_sad.png";

// Questions
const questions = [
{q:"Hi·ªán nay, nh·ªØng qu·ªëc gia n√†o v·∫´n ki√™n ƒë·ªãnh con ƒë∆∞·ªùng x√¢y d·ª±ng CNXH?",
 a:["Trung Qu·ªëc, Vi·ªát Nam, Cuba, L√†o","Trung Qu·ªëc, Nga, Vi·ªát Nam, Cam-pu-chia","Vi·ªát Nam, Cuba, H√†n Qu·ªëc, L√†o","Cuba, Trung Qu·ªëc, Cam-pu-chia, Nh·∫≠t B·∫£n"],c:1},
{q:"Ai kh·ªüi x∆∞·ªõng c·∫£i c√°ch m·ªü c·ª≠a Trung Qu·ªëc nƒÉm 1978?",
 a:["Mao Tr·∫°ch ƒê√¥ng","ƒê·∫∑ng Ti·ªÉu B√¨nh","Giang Tr·∫°ch D√¢n","T·∫≠p C·∫≠n B√¨nh"],c:2},
{q:"Nh·ªØng th√†nh t·ª±u c·∫£i c√°ch... ch·ª©ng minh ƒëi·ªÅu g√¨?",
 a:["CNXH c√≥ s·ª©c s·ªëng, c√≥ tri·ªÉn v·ªçng","CNTB kh√¥ng c√≤n duy nh·∫•t","CNXH m·ªü r·ªông kh√¥ng gian ƒë·ªãa l√≠","CNXH th√†nh h·ªá th·ªëng th·∫ø gi·ªõi"],c:1},
{q:"B√†i h·ªçc cho VN t·ª´ c·∫£i c√°ch TQ?",
 a:["KTTT t∆∞ b·∫£n","TT t·ª± do","L·∫•y ch√≠nh tr·ªã l√†m trung t√¢m","KTTT XHCN + m·ªü c·ª≠a"],c:4},
{q:"M·ª•c ti√™u l√¢u d√†i c·ªßa VN khi x√¢y d·ª±ng CNXH?",
 a:["D√¢n gi√†u, n∆∞·ªõc m·∫°nh, d√¢n ch·ªß, c√¥ng b·∫±ng, vƒÉn minh","Ph√°t tri·ªÉn CNTB","CNH b·∫±ng m·ªçi gi√°","Gi·∫£m vai tr√≤ nh√† n∆∞·ªõc"],c:1}
];

let i = 0, score = 0, state = "neutral", anim = 0, end = false;

// Draw
function draw() {
    ctx.clearRect(0,0,800,600);
    ctx.drawImage(bg,0,0,800,600);

    // bounce + subtle scale
    const y = 150 + Math.sin(anim/10)*8;
    const s = 1 + Math.sin(anim/20)*0.03;
    const img = state==="happy"?charHappy:state==="sad"?charSad:charNeutral;

    ctx.save();
    ctx.translate(400, y);
    ctx.scale(s, s);
    ctx.drawImage(img, -75, -75, 150, 150);
    ctx.restore();

    const q = questions[i];
    ctx.fillStyle="#000";
    ctx.font="22px Arial";
    ctx.fillText(q.q,40,350);
    ctx.font="20px Arial";
    q.a.forEach((a,k)=>ctx.fillText(`${k+1}. ${a}`,60,390+k*35));
    ctx.fillText(`C√¢u ${i+1}/${questions.length} | ƒêi·ªÉm: ${score}`,20,40);

    anim++;
    requestAnimationFrame(draw);
}
draw();

// Key events
document.addEventListener("keydown",e=>{
    if(end) return;
    const k = +e.key;
    if(k>=1 && k<=4) {
        if(k === questions[i].c){
            score++; state="happy"; correctSound.play();
        } else {
            state="sad"; wrongSound.play();
        }

        resultDiv.textContent = k===questions[i].c ? "‚úî ƒê√∫ng" : "‚úò Sai";
        resultDiv.className   = k===questions[i].c ? "correct" : "wrong";

        setTimeout(()=>{
            i++;
            state="neutral";
            resultDiv.textContent="";
            if(i>=questions.length) {
                end=true;
                alert(`üéØ Ho√†n th√†nh!\nƒêi·ªÉm: ${score}/${questions.length}`);
            }
        },1200);
    }
});

// Restart
restartBtn.onclick = ()=>{
    i=0; score=0; end=false; state="neutral";
};

// Music button
let musicOn = false;
musicBtn.onclick = ()=>{
    musicOn = !musicOn;
    if(musicOn) bgMusic.play(); else bgMusic.pause();
};
</script>
</body>
</html>
